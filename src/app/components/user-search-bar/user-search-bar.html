<div class="relative w-full max-w-md">
  <div class="relative">
    <input
      type="text"
      placeholder="Encontre novas pessoas..."
      class="w-full pl-12 pr-6 py-4 bg-white border border-stone-200 rounded-full shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:border-transparent transition-all"
      [formControl]="searchUsers"
    />
    <mat-icon class="absolute left-4 top-1/2 -translate-y-1/2 text-stone-400">search</mat-icon>

    @if (isLoading) {
      <div class="absolute right-4 top-1/2 -translate-y-1/2">
        <div
          class="animate-spin h-5 w-5 border-2 border-emerald-500 border-t-transparent rounded-full"
        ></div>
      </div>
    }
  </div>

  @if (users$ | async; as users) {
    @if (users.length > 0) {
      <ul
        class="absolute z-50 w-full mt-2 bg-white border border-stone-100 rounded-2xl shadow-xl max-h-64 overflow-y-auto overflow-x-hidden p-2 ring-1 ring-black ring-opacity-5"
      >
        @for (user of users; track user.id) {
          <li class="flex items-center justify-between p-3 rounded-xl">
            <div class="flex items-center gap-3">
              <div
                class="w-10 h-10 bg-emerald-100 text-emerald-700 rounded-full flex items-center justify-center font-bold"
              >
                {{ user.nickname?.charAt(0).toUpperCase() }}
              </div>
              <div class="flex flex-col">
                <span class="font-medium text-stone-800">{{ user.nickname }}</span>
                <span class="text-xs text-stone-400">#{{ user.publicIdentificationKey }}</span>
              </div>
            </div>
            <button (click)="sendInvite(user.id)">
              <mat-icon
                class="text-stone-300 hover:!text-emerald-500 cursor-pointer transition-colors"
                >add_circle</mat-icon
              >
            </button>
          </li>
        }
      </ul>
    } @else if ((searchUsers.value?.length ?? 0) >= 3) {
      <div
        class="absolute z-50 w-full mt-2 bg-white p-4 rounded-2xl shadow-lg border border-stone-100 text-center text-stone-500"
      >
        Nenhum usu√°rio encontrado para "{{ searchUsers.value }}"
      </div>
    }
  }
</div>
